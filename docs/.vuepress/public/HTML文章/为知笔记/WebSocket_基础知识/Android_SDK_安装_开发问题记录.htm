<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Android_SDK_安装_开发问题记录</title>
    
<style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;position:relative;padding: 20px 16px;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body a {word-wrap: break-word;text-decoration-skip-ink: none;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body li.wiz-list-align-style {list-style-position: inside; margin-left: -1em;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;padding: 2px;vertical-align:bottom;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #a7afbc;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #a7afbc;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-editor-body td > div:first-child {margin-top:0;}.wiz-editor-body td > div:last-child {margin-bottom:0;}.wiz-editor-body img.wiz-svg-image {box-shadow:1px 1px 4px #E8E8E8;}.wiz-editor-body .wiz-image-container {margin:0;max-width: 100%;display: inline-flex;flex-direction: column;}.wiz-editor-body .wiz-image-container .wiz-image-title {display:inline-block;text-align: center;color: #a7afbc;line-height: 18px;font-size: 12px;min-height: 18px;width: 100%;white-space: normal;}.wiz-hide {display:none !important;}.wiz-editor-body.wiz-editor-outline {padding-right:0; padding-left:0;}.wiz-editor-body.wiz-editor-outline .outline-container {margin:0; padding:0; line-height:1.5;}.wiz-editor-body.wiz-editor-outline .outline-container div {margin:0;}.wiz-editor-body.wiz-editor-outline .node {margin:0; padding: 0;}.wiz-editor-body.wiz-editor-outline .outline-container > .node {margin-right:24px; margin-left:30px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .children {display:none;}.wiz-editor-body.wiz-editor-outline .node .row {position:relative; padding-left:26px;}.wiz-editor-body.wiz-editor-outline .node .operator-container {width:36px;position:absolute; top:4px; left:-18px;}.wiz-editor-body.wiz-editor-outline .node .operator-bar {position:absolute; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;}.wiz-editor-body.wiz-editor-outline .node .switch {width:18px; height:18px;display:flex;flex-direction: column;align-items: center;overflow: hidden;}.wiz-editor-body.wiz-editor-outline .node .switch i {font-size:20px;position:relative;left:-1px;top:-1px;}.wiz-editor-body.wiz-editor-outline .node .switch.active {cursor:pointer;color:transparent; transition:transform 200ms ease 0s;}.wiz-editor-body.wiz-editor-outline .node.collapsed .switch.active {transform:rotateZ(-90deg);}.wiz-editor-body.wiz-editor-outline .node .row:hover .switch.active {color:#505F79}.wiz-editor-body.wiz-editor-outline .node .dot {display:flex; align-items:center; justify-content:center; border-radius:100%; width:18px; height:18px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .dot {background-color:rgba(80, 95, 121, .15);}.wiz-editor-body.wiz-editor-outline .node .dot-icon {background-color:#505F79; border-radius:100%; width:6px; height:6px;}.wiz-editor-body.wiz-editor-outline .node .child {margin-left:8px; border-left:1px solid #E6E9ED; padding-left:17px;}.wiz-editor-body.wiz-editor-outline .node .content {flex:1;outline:none; padding:4px 0;}.wiz-editor-body.wiz-editor-outline .node div.content {font-size:1rem;}.wiz-editor-body.wiz-editor-outline .node.complete > .row .content {text-decoration:line-through;color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .notes {outline:none; font-size:.8rem; color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .image {outline:none; padding-top:4px; padding-bottom:4px;}.wiz-editor-body.wiz-editor-outline .outline-container h1,.wiz-editor-body.wiz-editor-outline .outline-container h2,.wiz-editor-body.wiz-editor-outline .outline-container h3,.wiz-editor-body.wiz-editor-outline .outline-container h4,.wiz-editor-body.wiz-editor-outline .outline-container h5,.wiz-editor-body.wiz-editor-outline .outline-container h6 {margin:0;}body, .wiz-editor-body {  padding-left: 48px;  padding-right: 48px;}</style></head>

<body onload="parent.window.document.all.dd.height=document.body.scrollHeight" class="wiz-editor-body " data-wiz-document-type="common" spellcheck="false" ><div><div style="text-align: center;"><br></div><div><br></div><div><br></div><div><h1>问题：<span>SDK Manager 安装完成后弹出提示</span></h1><hr><div><span style="font-size:1.667rem" data-wiz-span="data-wiz-span"><b>问题描述：</b></span></div><div>SDK Manager 安装完成后<span>弹出</span>提示：</div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/de271b32-719f-46d2-9405-155ad7067613.png"></div><div style="text-align: center;">图 -&nbsp;<span>SDK Manager 安装完成后</span><span>弹出</span><span>提示</span></div><div><br></div></div></div></div><blockquote><div><div><div><span data-wiz-span="data-wiz-span" style="background-color: rgb(127, 127, 127); color: rgb(255, 255, 255);">The Android SDK and AVD Manager that you are currently using has been updated. It is recommended that you now close the manager window and re-open it. If you use Eclipse, please run Help &gt; Check for Updates to see if the Android plug-in needs to be updated.</span></div></div></div></blockquote><blockquote><div><div><div>译：</div></div></div><div><div><div>您当前使用的 Android SDK 和 AVD 管理器已更新。 建议您现在关闭管理器窗口并重新打开它。 如果您使用Eclipse，请运行Help &gt; Check for Updates 查看Android插件是否需要更新。</div></div></div></blockquote><div><div><div><br></div><div style="text-align: left;"><b><span data-wiz-span="data-wiz-span" style="font-size: 1.667rem;">原因与解法：</span></b></div><div><span>如果安装过程中遇到一些动作执行失败的问题，不用担心，SDK Manager 第一次执行完所有的安装命令后会弹出一个更新完成的提示，大胆点击 OK，错误窗口不会消失，而且 SDK Manager 上会自动跟你勾选安装失败的包，已安装的不会勾选，已安装的包的状态会变为“Installed”。接下来你就去解决引起错误的原因，再重新使用 SDK Manager 安装就行。</span><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><h1>问题：<span>Stopping ADB server failed (code -1).</span></h1><hr><div><br></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;"><b>问题描述：</b></span></div><div>SDK Manager 安装 SDK 时报错，如下图：</div><blockquote><div><span>Stopping ADB server failed (code -1).</span></div><div><span>停止 ADB 服务器失败（错误代码 -1）。</span></div></blockquote><div><span><br></span></div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/9d611801-7107-4573-b3bd-03039ec2a626.png"></div><div style="text-align: center;">图 1 - SDK Manager 错误日志</div><div><b>日志关键信息：</b></div></div><blockquote><div>Installing Android SDK Platform-tools, revision 29.0.6</div><div>Stopping ADB server failed (code -1).</div><div>Installed Android SDK Platform-tools, revision 29.0.6</div></blockquote><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">原因：</span></b></div><div>网上说是没给 adb 配置环境变量。<span>不过我配置环境变量后重装时还是会有这个问题。</span></div><div><span>不是大问题，不影响安装。</span><span><br></span></div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">解</span></b><b></b><b style="font-size:1.667rem;"></b><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">法：</span></b></div><div>安装后给 adb 配置环境变量，即配置 Android 环境变量。</div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">Ref：</span></b></div><blockquote><div><a href="https://blog.csdn.net/l1336037686/article/details/80217603">《<span>csdn - 安装android SDK时报Stopping ADB server failed (code -1).错误》</span></a></div><div><br></div></blockquote><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><h1>问题：Download finished with wrong size</h1></div><div><hr><br></div><div><b style="font-size:1.667rem;">问题描述：</b></div><div>图形版 SDK Manager 安装 DHU（Desktop Head Unit）时，日志中报了一个错误（如图 1）：</div></div><blockquote><div><span data-wiz-span="data-wiz-span" style="background-color: rgb(127, 127, 127); color: rgb(255, 255, 255);">Download finished with wrong size. Expected 2691901 bytes, got 2615480 bytes.</span></div></blockquote><div><div><blockquote><div>译：</div><div>伴随着一个错误的文件大小，下载完成了。期待的是&nbsp;<span>2691901 bytes, 得到的是 2615480 bytes.</span></div></blockquote><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/68396465-ae7f-40a0-a960-339fa51d6309.png"></div><div style="text-align: center;">图 1 - 错误提示</div><div><br></div></div><div><div><span>在它前面的一条日志：</span></div></div><blockquote><div><div><span>Downloading Android Auto Desktop Head Unit emulator, revision 1.1</span></div></div><div><span>下载&nbsp;</span><span>Android Auto Desktop Head Unit 模拟器，修订版本号 1.1</span></div></blockquote><div><br></div><div><br></div><div><br></div><div><span style="font-size:1.5rem;"><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题原因：</span></b></span></div><div><br></div><div><b style="font-size:1.5rem;">原因分析：</b></div><div><span>如图 1 所示，下载失败的这个包名为 Desktop Head Unit，官方简称 DHU，中文“桌面头部单元”，即“桌面主机”。Head Unit 头部单元的意思就是主机。详见</span><a href="https://developer.android.com/training/cars/testing#install-dhu-1.1">《android -Install the DHU version 1.1》</a><span>，</span><br></div><div><br></div><div><b>那么为什么安装<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">会失败</span>呢？</b></div><blockquote><div>因为下载下来的这个包的文件大小不是这个包的安装配置文件中指定的大小，一个 Byte 都不能错。</div></blockquote><div><br></div><div><b><span>那么</span>为什么文件大小<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">不是指定的大小</span>呢？</b></div><blockquote><div>网上说是 SDK Manager 中官方给的源的问题，从<span>官方的</span>另外一个源下就可以了。实践证明确实如此。</div></blockquote><div><br></div><div><b><span>那么</span>为什么&nbsp;<span>SDK Manager 中官方给的<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">源会有问题</span>呢？</span></b></div><blockquote><div><span>网上没有说明原因，但个人推测，应该是在不断地更新中，包升级了，但是没有动原来的源，而是搞一个新的源。而单独的 SDK Manager 早已不再被官方维护更新了，官方搞了个新版的单独的 SDK Manager，可惜是个 CMD 形式的。</span></div></blockquote><blockquote><div><span><br></span></div><div>为了验证这一猜测，我决定手动下载这个包。</div><div><div><div>但是，怎么手动下载呢？我不知道下载地址，网上也查不到。我翻看 Manager 的日志，发现了一个跟下载 DHU 有关的一个 URL，如下图。</div></div></div></blockquote><div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/cd226ea1-5706-4611-841b-f6ecb3e7a8b3.png"></div><div style="text-align: center;"><span>图 2 - SDK Manager 日志</span></div><div style="text-align: center;"><span><br></span></div></div></div><blockquote><div><div><div><span>圈中的信息如下：</span></div></div></div></blockquote><blockquote><div><ul><li><span>Fetching URL: http://dl.google.com/android/repository/addon.xml</span></li><li>Found Android Auto Desktop Head Unit emulator, revision 1.1</li></ul></div></blockquote><blockquote><div>但是分析 addon.xml 中关于 DHU 这个包的信息发现，并没有这个包的下载链接，如下图。失败。</div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/3df09721-6068-4069-a370-cae0fcc7af78.png"></div><div style="text-align: center;">图 3 - addon.xml 中 <span>DHU<span>&nbsp;的</span></span>配置信息</div></div><div><br></div><div>接下来<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">用 Fiddler 抓包 SDK Manger 的包</span><span data-wiz-span="data-wiz-span">（具体操作见笔记《</span><span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);"><a href="/views/技术总结/前端技术/为知笔记/排错_基本知识（index）.html">排错基本技能</a></span><span data-wiz-span="data-wiz-span">》之《端口抓包》），</span>功夫不负有心人，终于取到了 SDK Manager 下载包的 URL ，<span>URL 如下图：</span></div><div><span><a href="http://dl.google.com/android/repository/desktop-head-unit-windows_r01.1.zip" style="text-decoration-skip-ink:none;">http://dl.google.com/android/repository/desktop-head-unit-windows_r01.1.zip</a></span></div></blockquote><br><div style="text-align: center;"><div><img src="Android_SDK_安装_开发问题记录_files/6051ec15-05ff-4d2e-9101-b20f3aedc20f.png"></div></div><div style="text-align: center;">图 4 - Fiddler 抓 SDK Manager 的包</div><blockquote><div><div><br></div></div></blockquote><blockquote><div><span>使用 URL 手动下载这个文件后，发现大小为 <span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">2,615,480</span> byte，正好是错误提示中显示的文件大小，这说明</span><span>手动下载的这个包和 SDK Manager 下载的是一样，那么这说明包有问题跟代理有问题、数据被墙毫无关系。再说了，文件要么全部被墙，要么全不墙，没有把一个文件墙一部分的道理。</span></div></blockquote><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/889fa085-5634-4116-bc7c-a9e2452b3c68.png"></div><div style="text-align: center;"><span>图 5 -<span>&nbsp;手动下载的包的文件大小</span></span></div><div><br></div></div><blockquote><div><div><span>按照网上的说法，我从官方另一个源（</span><a href="https://dl-ssl.google.com/android/repository/extras/auto/desktop-head-unit-windows_r01.1.zip">https://dl-ssl.google.com/android/repository</a><span>）上下载了这个包，</span><span>包下载的 URL 是：</span></div></div><div><div><span><a href="https://dl-ssl.google.com/android/repository/extras/auto/desktop-head-unit-windows_r01.1.zip" style="text-decoration-skip-ink:none;">https://dl-ssl.google.com/android/repository/extras/auto/desktop-head-unit-windows_r01.1.zip</a></span><span>。（</span><span>该链接来自</span><span><a href="https://www.cnblogs.com/wuxiaoshi/p/13289860.html" style="text-decoration-skip-ink:none;">《<span style="color:rgb(0, 0, 0);">cnblogs - Android SDK</span>》</a>）</span></div></div><div><div><span>此时，这个</span><span>包的</span><span>大小和错误中要求的大小完全相等，应该是配置文件要的那个包了，错不了。</span></div></div><div><div>综上，可以证明 SDK Manager 所使用的老源下载的这个包跟新源下载的这个包是不一样的。至于为什么，则是 google 长期对软件包更新带来的影响，它在放弃旧 SDK Manager 的维护时，应该同时放弃了对旧源的维护，于是<span>老的源上的包有的没有随配置文件的更新而更新，于是就出现了这个问题。</span></div></div></blockquote><div><br></div><div><br></div><div><div><div><span><b style="font-size:1.5rem;">分析结果：</b></span></div><div><span>图形版 SDK Manager 所使用的</span><span>附件站点（镜像源）</span><span>是老的，老的源上的包有的没有随配置文件的更新而更新，更新后的配置文件想要的这个 DHU 包在新源上，所以才出现这个问题。</span></div><div><span>不过，这个问题并不影响你使用这个包，只是你需要手动安装这个包。</span></div><div><br></div><div><br></div><div><span><div><span style="font-size:1.5rem;"><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题解法：</span></b></span></div><div><b><br></b></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;">方法一</span></b>：偷梁换柱法。手动下载需要的包，把问题包替换，再让 SDK Manager 安装。傻白甜都能学会的方法，推荐。</div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;">方法二</span></b>：过来人法。手动安装该包，安装方法就是直接解压，解压路径见当前笔记《Q：如果手动解压，那如何知道要解压到哪个文件夹呢？》</div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;">方法三</span></b>：釜底抽薪法。给 SDK Manager<span>&nbsp;指定</span>其他的源。该法难度大，资料少，不推荐。</div><div><span><br></span></div><div><span style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);" data-wiz-span="data-wiz-span">Tips：有的人在下 SDK Platform 包时会遇到同样的问题，问题的原因和解法也跟这相同，只是安装路径不同，路径可参考上面提到的，也可以网查。</span><span><br></span></div><br><br></span></div><div><b style="font-size:1.167rem;background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);">方法一</b><b><span data-wiz-span="data-wiz-span" style="font-size:1.167rem;">的具体操作：</span></b></div><div>这里主要说<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">方法一</span>的具体操作。</div><div><span>首先在新源上手动下载这个包，在 SDK Manager 的目录中，有一个 temp 的目录（</span><span style="color:rgb(255, 104, 32);" data-wiz-span="data-wiz-span">如图 6</span><span>）</span><span>，Manager 下载了但没安装的包会在这里，把新源下的包替换掉这儿的包</span><span>（</span><span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">如图 6</span><span>）</span><span>，再重新点击 Manager 的 install 按钮安装（</span><span style="color:rgb(255, 104, 32);">如图 7</span><span>），即可解决问题。这时候 Manager 识别这个包的时候就不会报错了（</span><span style="color:rgb(255, 104, 32);" data-wiz-span="data-wiz-span">如图 8</span><span>），会把它解压到它该去的位置（</span><span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">如图 9</span><span>）。</span></div><div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/c62829b7-eee7-47e7-82a9-5018cde01490.png"></div><div style="text-align: center;"><span>图 6 -<span>&nbsp;新源的包替换&nbsp;</span></span><span>temp 目录的包</span></div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/0d64232e-0213-4b4e-8852-dd53ae1f822f.png"></div><div style="text-align: center;"><span>图 7 -</span><span>&nbsp;SDK Manager 重新 Install</span></div></div></div></div><div><div><div><div><br></div></div></div></div><div style="text-align: center;"><div><div><img src="Android_SDK_安装_开发问题记录_files/07499932-4000-459d-bfc2-05cdfe977994.png"></div></div></div><div style="text-align: center;"><div><div><span>图 8 - 错误日志和成功日志</span></div></div></div><div><div><div><br></div></div></div><div style="text-align: center;"><span><img src="Android_SDK_安装_开发问题记录_files/84c188e7-f5a9-46c9-a7f6-4cfa88812eec.png"><br></span></div><div style="text-align: center;"><span>图 9 - 解压安装的路径和内容</span></div><div><span><br></span></div><div><br></div><div><span><br></span></div><div><span><b><span data-wiz-span="data-wiz-span" style="font-size:1.5rem;">相关疑问：</span></b></span></div><div><b><span style="font-size:1.333rem;" data-wiz-span="data-wiz-span"><br></span></b></div><div><b><span><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">Q：</span>如果手动解压，那如何知道要</span><span>解压到哪个文件夹呢？</span></b></div><div><div><b><span style="font-size:1.333rem;" data-wiz-span="data-wiz-span">A：</span></b>网上查不到 DHU 相关的办法，所以只能先通过 Manager 解压安装，看看 Manager 把它放哪儿了。</div></div></div></div><blockquote><div><div><div><div>现在知道了<span>解压安装的路径是<span>&nbsp;</span></span><span data-wiz-span="data-wiz-span" style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);">~/extra/google/auto</span><span data-wiz-span="data-wiz-span">，如下图，那这个<span>路径是哪里规定的呢？接下来对这个这个问题分析一下。</span></span></div></div></div></div><div><div><div><div>首先，比对的新旧两个源下的包的内容。</div></div></div></div><div><div><div><div>如下图，<span>对比&nbsp;</span>Home 目录内容，<span>左为符合大小</span><span>（<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">新源</span>）</span><span>的，右为不符合大小</span><span>（</span><span style="color:rgb(255, 104, 32);" data-wiz-span="data-wiz-span">旧源</span><span>）</span><span>的，</span><span>新源</span><span>的包对比旧源的包，新源的包删除 source.properties 文件，增加了 Home 目录，其他内容都完全一样。看来两个包的本质是一样的，只是解构稍有调整。另外，</span><span>这里似乎没有解压路径信息。</span></div></div></div></div></blockquote><div><div><div><div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/ab8824be-dc1b-43a4-a484-c60d8f082f68.png"></div><div style="text-align: center;"><span>图 10 -&nbsp;</span><span>Home 目录内容对比</span></div><div style="text-align: center;"><br></div></div></div></div></div></div><blockquote><div><div><div><div><div><span>之前在&nbsp;</span><span>addon.xml 中看到了这个包的很多信息，例如文件规定的大小、文件名等等。这里面会不会有呢？</span></div></div></div></div></div><div><div><div><div><div>如下图，翻看 addon.xml 中关于这个包的配置信息，结合包的<span>解压安装路径<span>&nbsp;</span></span><span data-wiz-span="data-wiz-span" style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);">~/extra/google/auto</span><span data-wiz-span="data-wiz-span">，发现</span><span style="color:rgb(255, 104, 32);" data-wiz-span="data-wiz-span">配置信息中正好能找到路径</span><span data-wiz-span="data-wiz-span">上的目录名 extra、google、auto（如下图）。</span><span>因此我<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">推测解压路径就是从 addon.xml 这个配置文件中读取的</span>。</span></div></div></div></div></div></blockquote><div><div><div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/ac4441f5-6835-4aa4-9116-d376e7a9c6c5.png"></div><div style="text-align: center;"><span>图 11 - DHU 的 addon.xml 配置信息</span></div></div></div></div></div><div style="text-align: center;"><span><br></span></div><blockquote><div><div><div><div><div><div>但有一点不明白：压缩文件里主目录是一个目录，名为 “desktop-head-unit” （<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">如图 10</span> 左侧），安装程序怎么知道是把主目录里的文件，而不是把主目录整个移动过去呢？</div></div></div></div></div></div><div><div><div><div>或许安装程序要的就是这样有个主目录的压缩文件，这个要求可能是根据配置文件来的。</div></div></div></div></blockquote><div><div><div><div><br></div><div><br></div></div><div><br></div><div><span style="font-size:1.667rem;" data-wiz-span="data-wiz-span"><b>Ref：</b></span></div></div></div><blockquote><div><div><div><a href="https://stackoverflow.com/questions/46998252/unable-to-install-android-sdk-platform-tools-from-sdk-manager/47005171#47005171">《<span style="color:rgb(0, 0, 0);">stackoverflow - 无法从 SDK Manager 安装“Android SDK Platform Tools”》</span></a></div></div></div><div><div><div><a href="https://stackoverflow.com/questions/47719420/sdk-platform-android-8-1-0-cant-download">《stackoverflow - SDK 平台 Android 8.1.0 - 无法下载》</a></div></div></div><div><div><div><a href="https://stackoverflow.com/questions/26499617/android-sdk-manager-download-finished-with-wrong-checksum">《<span style="color:rgb(0, 0, 0);">stackoverflow -&nbsp;</span><span style="color:rgb(0, 0, 0);">Android SDK Manager 下载完成，校验和(checksum)错误？》</span></a></div></div></div><div><div><div><a href="https://www.stechies.com/download-finished-wrong-size/">《<span style="color:rgb(0, 0, 0);">stechies - 下载完成，大小错误。》</span></a></div></div></div><div><div><div><a href="https://stackoverflow.com/questions/10219519/download-finished-with-wrong-size-eclipse-and-android">《stackoverflow - 下载完成但大小错误 - eclipse 和 android》</a></div></div></div><div><div><div><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/416">《<span style="color:rgb(0, 0, 0);">MDN - 416 Range Not Satisfiable》</span></a></div></div></div><div><div><div><a href="https://blog.csdn.net/weixin_44997802/article/details/113705228">《<span style="color:rgb(0, 0, 0);">csdn - SDK安装报错HTTP Status 416》</span></a></div></div></div><div><div><div><a href="https://blog.csdn.net/guominyou/article/details/79563599">《<span style="color:rgb(0, 0, 0);">csdn -&nbsp;</span><span style="color:rgb(0, 0, 0);">Android SDK Manager 无法下载》</span></a></div></div></div></blockquote></div><div><div><div><br></div><div><br></div><div><br></div><div><br></div><br></div><div><br></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><h1>问题：Download interrupted: Unexpected HTTP Status 416</h1><div><div><hr></div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题描述：</span></b></div><div><span>图形版 SDK Manager 安装 DHU（Desktop Head Unit）时，日志中报了一个错误：</span><br></div></div></div></div><blockquote><div><span style="color: rgb(255, 255, 255); background-color: rgb(127, 127, 127);" data-wiz-span="data-wiz-span">Download interrupted: Unexpected HTTP Status 416</span></div><blockquote></blockquote><div><div><div><span data-wiz-span="data-wiz-span">译：</span></div><div><span data-wiz-span="data-wiz-span">下载被中断：未预料到的 HTTP 状态码 416</span></div></div></div></blockquote><div><div><div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题原因：</span></b><br></div><div><b style="font-size:1.333rem;">原因分析：</b></div><div><span>网查资料，说是要&nbsp;</span><span>配置 SDK Manager&nbsp;</span><span>强制 https 使用 http。于是进行配置，</span><span>如下图。</span></div><div><span>无效。</span><span><br></span></div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/c3cd5836-a784-48b8-8973-afda645f4b21.png"></div><div style="text-align: center;">图 1 - 配置 SDK Manager&nbsp;<span>强制 https 使用 http</span></div><div><br></div><div><br></div><div>网上说要关闭杀毒软件，于是照做。</div><div>无效。</div><div><br></div><div>网上又说，需要手动安装已经下载到本地的包，原因是包没问题，而是官方的源上的包不是 SDK 想要的大小。</div><div>……（心累）</div><div><br></div></div><div><b style="font-size:1.333rem;">分析结论：</b></div><div><span>在 SDK Manager 下载软件包时，“Download interrupted: Unexpected HTTP Status 416” 这个错误一般都会伴随着另一个错误“Download finished with wrong size”。</span></div><div>服务器返回 HTTP 状态码 416 ，表示你要下载文件与你在 Header 中（用 Range）指定的大小不一致。如果你不指定大小就没这问题。</div><div>具体原因不是被墙，而是 Google 自己的源仓库搞出来的问题，详见当前笔记<u>《遇到问题：Download finished with wrong size》</u></div><div><br></div><div>服务器响应 HTTP 416 的原因是你想下载的文件的大小与服务器实际给你返回的文件的大小不一致。如果重复几次安装都报这个错误，那么这与网络是否畅通、是否被墙无关，而与镜像源上的文件有关，具体来说，就是这个镜像源上的这个包是旧版的，不是你（xml 配置文件）想要的。</div><div>为什么会这样呢？这是因为 google 后来搞了个新的镜像源，一部分升级后的包放在了这个上面，而 SDK Manager 默认使用的是旧镜像源，所以下载不到升级后的包。换句话说，就是 SDK Manager 用镜像源没有随着软件包的配置文件（http://...xml）一同升级。</div><div><br></div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">解决办法：</span></b></div><div><br></div><div><div>由于修改 SDK Manager 使用的镜像源（不是代理）的相关资料少，导致修改难度增大，因此最好方法是从新镜像源上手动下载该软件包，如&nbsp;</div></div></div><blockquote><div><div><div><div>Desktop Head Unit 1.1：<a href="https://dl-ssl.google.com/android/repository/extras/auto/desktop-head-unit-windows_r01.1.zip">https://dl-ssl.google.com/android/repository/extras/auto/desktop-head-unit-windows_r01.1.zip</a></div></div></div></div></blockquote><blockquote><blockquote><div><div><div><div>更多下载地址见&nbsp;<a href="https://www.cnblogs.com/wuxiaoshi/p/13289860.html">《cnblogs - Android SDK》</a>&nbsp;</div></div></div></div></blockquote></blockquote><div><div><div><div>接着，用把手动下载的压缩包替换 SDK Manager.exe 所在目录下的 temp 目录下的同名压缩包，用 SDK Manager 再 Install 一遍。这时 SDK Manager 不会再去下载压缩包，而是会把替换后的包成它自己下载的包进行处理，完成该软件包的安装。</div></div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">Ref：</span></b></div></div></div><blockquote></blockquote><div><div><div><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/416">《<span style="color:rgb(0, 0, 0);">MDN - 416 Range Not Satisfiable》</span></a></div></div></div><div><div><div><a href="https://blog.csdn.net/weixin_44997802/article/details/113705228">《csdn - SDK安装报错HTTP Status 416》</a></div></div></div><div><div><br></div><div><br></div><div><br></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><h1><span>问题：</span><span>A folder failed to be moved.</span></h1><hr></div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题描述：</span></b><br></div><div><div><div>SDK Manager 在安装软件包时，突然弹窗报错，错入如下图：</div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/70e4e3ec-a87f-4506-add0-f32caf7e5a59.png"></div><div style="text-align: center;">图 1 -&nbsp;<span>SDK Manager<span>&nbsp;报错</span></span></div></div></div><blockquote><div><div><div><div><span style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);" data-wiz-span="data-wiz-span">A folder failed to be moved. On Windows this typically means that a program is using that folder (for example Windows Explorer or your anti-virus software.) Please momentarily deactivate your anti-virus software or close any running programs that may be accessing the directory 'D:\1_System\1_Installation\1_SDE\Android\SDK_Tools\android-sdk-windows\tools'. When ready, press YES to try again.</span></div></div></div></div></blockquote><blockquote><div><div><div><div><span>译：</span></div></div></div></div></blockquote><blockquote><div><div><div><div><span>文件夹移动失败。 在 Windows 上，这通常意味着某个程序正在使用该文件夹（例如 Windows 资源管理器或您的防病毒软件。）请暂时停用您的防病毒软件或关闭任何可能正在访问该目录（</span><span>'</span><span>D:\1_System\1_Installation\1_SDE\Android\SDK_Tools\android-sdk-windows\tools</span><span>'</span><span>）的正在运行的程序</span><span>。 准备好后，按 YES 再试一次。</span></div></div></div></div><div><span><br></span></div></blockquote><div><span>此时错误日志如下图：</span></div><div><div><div><div><div style="text-align: center;"><img src="Android_SDK_安装_开发问题记录_files/233c1668-2771-4db2-9d84-bd2ced0e7eb5.png"></div><div style="text-align: center;">图 2 -&nbsp;<span>SDK Manager</span><span>&nbsp;日志</span></div><div style="text-align: center;"><br></div></div></div></div></div><blockquote><div><div><div><span data-wiz-span="data-wiz-span" style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);">Installing Android SDK Tools, revision 25.2.5(Obsolete)</span></div></div></div><div><div><div><span data-wiz-span="data-wiz-span" style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);">Failed to rename directory&nbsp;</span></div></div></div><div><div><div><span data-wiz-span="data-wiz-span" style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);">D:\1_System\1_Installation\1_SDE\Android\SDK_Tools\android-sdk-windows\tools to&nbsp;</span></div></div></div><div><div><div><span style="background-color:rgb(127, 127, 127);color:rgb(255, 255, 255);" data-wiz-span="data-wiz-span">D:\1_System\1_Installation\1_SDE\Android\SDK_Tools\android-sdk-windows\temp\ToolPackage.old01.</span></div></div></div></blockquote><div><div><br></div><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题原因：</span></b></div><div>网上说可能是 Eclipse、SDK Manager 自身锁定了这个目录。我的电脑上没装 Eclipse，SDK Manager 的话，到有可能，因为我之前运行过 CMD 版的 SDK Manager。</div><div>我在任务管理器中 找到了 adb.exe 进程并关闭了它，但找不到 SDK Manager 相关的进程，看到一个 java.exe 的，关闭之后图形版的 SDK Manager 关闭了。后来电脑蓝屏了，重启了。这时候我再安装这个，没问题了。</div><div>所以总的来说，<span data-wiz-span="data-wiz-span" style="color:rgb(255, 104, 32);">错误原因是某个进程占用了 SDK Manager 目录并锁定了它，至于是谁现在也说不清楚。</span></div><div><br></div><div><div>从错误日志可以看出，这个错误是在安装 SDK Tools v25.2.5 的时候报的，但是报错之后最后 SDK Manager 又显示安装好了<span>。有点搞不懂这个错误，或许这个错误没有什么意义吧。</span></div><div><br></div></div><div><b><span data-wiz-span="data-wiz-span" style="font-size:1.667rem;">问题解法：：</span></b></div><div>重启。如果知道是那个进程占用了目录就结束那个进程。</div></div></div><br></div>

  <script type="text/javascript">
    /**
    * 让 iframe 中的 <a> 打开新页面
    */
    let aDoms = document.getElementsByTagName("a")
    for ( let aDom of aDoms ) {
      let oldHref = aDom.href;
      let newHref = "javascript:window.open('" + oldHref + "')";
      // console.info("aDom", aDom);
      aDom.href = newHref;
    }
  </script>

</body></html>