<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>探究_SDK_Manager_指定_repository（镜像源）的依据</title>
    
<style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;position:relative;padding: 20px 16px;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body a {word-wrap: break-word;text-decoration-skip-ink: none;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body li.wiz-list-align-style {list-style-position: inside; margin-left: -1em;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;padding: 2px;vertical-align:bottom;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #a7afbc;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #a7afbc;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-editor-body td > div:first-child {margin-top:0;}.wiz-editor-body td > div:last-child {margin-bottom:0;}.wiz-editor-body img.wiz-svg-image {box-shadow:1px 1px 4px #E8E8E8;}.wiz-editor-body .wiz-image-container {margin:0;max-width: 100%;display: inline-flex;flex-direction: column;}.wiz-editor-body .wiz-image-container .wiz-image-title {display:inline-block;text-align: center;color: #a7afbc;line-height: 18px;font-size: 12px;min-height: 18px;width: 100%;white-space: normal;}.wiz-hide {display:none !important;}.wiz-editor-body.wiz-editor-outline {padding-right:0; padding-left:0;}.wiz-editor-body.wiz-editor-outline .outline-container {margin:0; padding:0; line-height:1.5;}.wiz-editor-body.wiz-editor-outline .outline-container div {margin:0;}.wiz-editor-body.wiz-editor-outline .node {margin:0; padding: 0;}.wiz-editor-body.wiz-editor-outline .outline-container > .node {margin-right:24px; margin-left:30px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .children {display:none;}.wiz-editor-body.wiz-editor-outline .node .row {position:relative; padding-left:26px;}.wiz-editor-body.wiz-editor-outline .node .operator-container {width:36px;position:absolute; top:4px; left:-18px;}.wiz-editor-body.wiz-editor-outline .node .operator-bar {position:absolute; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;}.wiz-editor-body.wiz-editor-outline .node .switch {width:18px; height:18px;display:flex;flex-direction: column;align-items: center;overflow: hidden;}.wiz-editor-body.wiz-editor-outline .node .switch i {font-size:20px;position:relative;left:-1px;top:-1px;}.wiz-editor-body.wiz-editor-outline .node .switch.active {cursor:pointer;color:transparent; transition:transform 200ms ease 0s;}.wiz-editor-body.wiz-editor-outline .node.collapsed .switch.active {transform:rotateZ(-90deg);}.wiz-editor-body.wiz-editor-outline .node .row:hover .switch.active {color:#505F79}.wiz-editor-body.wiz-editor-outline .node .dot {display:flex; align-items:center; justify-content:center; border-radius:100%; width:18px; height:18px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .dot {background-color:rgba(80, 95, 121, .15);}.wiz-editor-body.wiz-editor-outline .node .dot-icon {background-color:#505F79; border-radius:100%; width:6px; height:6px;}.wiz-editor-body.wiz-editor-outline .node .child {margin-left:8px; border-left:1px solid #E6E9ED; padding-left:17px;}.wiz-editor-body.wiz-editor-outline .node .content {flex:1;outline:none; padding:4px 0;}.wiz-editor-body.wiz-editor-outline .node div.content {font-size:1rem;}.wiz-editor-body.wiz-editor-outline .node.complete > .row .content {text-decoration:line-through;color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .notes {outline:none; font-size:.8rem; color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .image {outline:none; padding-top:4px; padding-bottom:4px;}.wiz-editor-body.wiz-editor-outline .outline-container h1,.wiz-editor-body.wiz-editor-outline .outline-container h2,.wiz-editor-body.wiz-editor-outline .outline-container h3,.wiz-editor-body.wiz-editor-outline .outline-container h4,.wiz-editor-body.wiz-editor-outline .outline-container h5,.wiz-editor-body.wiz-editor-outline .outline-container h6 {margin:0;}body, .wiz-editor-body {  padding-left: 48px;  padding-right: 48px;}</style></head>

<body onload="parent.window.document.all.dd.height=document.body.scrollHeight" class="wiz-editor-body " data-wiz-document-type="common" spellcheck="false" style="opacity: 1;" ><div style="text-align: center;"><br></div><div><br></div><div><br></div><h1>前言：</h1><hr><div>由于网上搜索 SDK Manager 换源时，方法都是设置代理，于是让我产生一种想法：“SDK Manager 的代理（Proxy）就是源。”但我始终觉得别扭，到底是真的是 SDK Manager 的作者这样设计的，把 Proxy 作为 Source，还是网上这些人搞错了，被人误人子弟了。于是我想对这个问题一探究竟。</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><span><h1>推测：</h1></span><hr></div><div><span><div>以 DHU（Desktop Head Unit）为例，如下 URL，我对比它的 xml 文件与文件下载的 URL，发现它们在同一级别路径下。</div></span></div><blockquote><div><span><div><div><span>&nbsp;xml 文件的 URL：&nbsp;<a href="http://dl.google.com/android/repository/addon.xml" style="text-decoration-skip-ink:none;">http://dl.google.com/android/repository/addon.xml</a></span></div></div></span></div><div><span><div><div>文件下载的 URL：&nbsp;<a href="http://dl.google.com/android/repository/desktop-head-unit-windows_r01.1.zip" style="text-decoration-skip-ink:none;">http://dl.google.com/android/repository/desktop-head-unit-windows_r01.1.zip</a></div></div></span></div></blockquote><div><span><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size: 1.167rem;">因此，我推测：</span></b></div><div><span><div><ul><li><span><div><div><span><div><span>文件下载的 URL 的依据是 xml 文件的 URL。</span></div></span></div></div></span></li><li><span><div style="text-align: left;"><span>文件下载的 URL 是”“</span><span>xml 的所在目录的 URL + xml 中记载的文件的名称”</span></div></span></li></ul></div></span></div></span></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><h1>证明：</h1><hr><div><br></div><div><br></div><div><br></div><h2><b>测试一：使用 xml 文件的 URL 和 xml 文件中记录的包名来下载包</b></h2><hr><div><br></div><div><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试目标：</span></b></div><div><span>官方提供的 xml</span><span>&nbsp;：</span></div><blockquote><div><a href="http://dl.google.com/android/repository/addon.xml" style="text-decoration-skip-ink: none;">http://dl.google.com/android/repository/addon.xml</a></div><div><a href="http://dl.google.com/android/repository/extras/intel/">http://dl.google.com/android/repository/extras/intel/</a><a href="http://dl.google.com/android/repository/addon.xml" style="text-decoration-skip-ink: none;">addon.xml</a></div></blockquote><div><br></div><div style="text-align: left;"><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试方法：</span></b></div><div><span>把 xml 中记载的文件的名称拼接在 URL 相同分段的后面，即“</span><span>URL </span><span>相同分段&nbsp;</span><span>+ &lt;sdk:url&gt;”，例如：</span></div><blockquote><div><span><a href="http://dl.google.com/android/repository/addon.xml" style="text-decoration-skip-ink: none;">http://dl.google.com/android/repository/</a>&nbsp;+ desktop-head-unit-windows_r01.1.zip</span></div><div><span><a href="http://dl.google.com/android/repository/addon.xml" style="text-decoration-skip-ink: none;">http://dl.google.com/android/repository/</a></span><span>&nbsp;+&nbsp;</span><span>google_play_services_3265130_r12.zip</span></div><div><span><a href="http://dl.google.com/android/repository/extras/intel/" style="text-decoration-skip-ink: none;">http://dl.google.com/android/repository/extras/intel/</a>&nbsp;+&nbsp;</span><span>haxm-macosx_v7_5_1.zip</span></div><div><span><a href="http://dl.google.com/android/repository/extras/intel/" style="text-decoration-skip-ink: none;">http://dl.google.com/android/repository/extras/intel/</a>&nbsp;+&nbsp;</span><span>haxm-windows_v7_5_6.zip</span></div></blockquote><div><span><br></span></div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试结果：</span></b></span></div><div>均下载成功。</div><div><br></div><div style="text-align: left;"><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试结论：</span></b></div><div>一定程度上可以证明<span>文件下载的 URL 的依据是 xml 文件的 URL。</span></div><div>这样看来，<span data-wiz-span="data-wiz-span" style="background-color: rgb(255, 0, 0);">虽然直接访问一个 URL（如&nbsp;</span><a href="http://dl.google.com/android/repository/addon.xml" style="text-decoration-skip-ink: none;"><span data-wiz-span="data-wiz-span" style="background-color: rgb(255, 0, 0);">http://dl.google.com/android/repository/</span></a><span data-wiz-span="data-wiz-span" style="background-color: rgb(255, 0, 0);">&nbsp;）是 404，但并不代表不可以访问这个路径下的文件。</span>这个路径<span>只是</span>被禁止直接访问了，不让你查看这个路径下的文件的目录。</div><div><br></div><div><br></div><div><br></div><div><h2><b>测试二：<span>使用第三方提供的 xml 文件的 URL 和 xml 文件中记录的包名来下载包</span></b></h2><hr><div><br></div><div style="text-align: left;"><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试目标：</span></b></div></div><div><span>第三方提供的 xml<span>&nbsp;：</span></span></div><blockquote><div>amazona web services：</div></blockquote><blockquote><blockquote><div><a href="https://s3.amazonaws.com/android-sdk-manager/redist/addon.xml">https://s3.amazonaws.com/android-sdk-manager/redist/addon.xml</a></div></blockquote></blockquote><div><span><br></span></div><div><span><br></span></div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试方法：</span></b></span></div><div><span><div><span>把 xml 中记载的文件的名称拼接在 URL 相同分段的后面，即“</span><span>URL<span>&nbsp;</span></span><span>相同分段&nbsp;</span><span>+ &lt;sdk:url&gt;”，如</span></div><div><span><a href="https://s3.amazonaws.com/android-sdk-manager/redist/addon.xml" style="text-decoration-skip-ink: none;">https://s3.amazonaws.com/android-sdk-manager/redist/</a>&nbsp;+&nbsp;</span><span>amazon_maps_api_v2.2.zip</span></div><div><a href="https://s3.amazonaws.com/android-sdk-manager/redist/addon.xml" style="text-decoration-skip-ink: none;">https://s3.amazonaws.com/android-sdk-manager/redist/</a><span>&nbsp;+&nbsp;</span><span>FireTV.zip</span></div><br></span></div><div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试结果：</span></b></span></div></div><div><span>均下载成功。</span></div><div><span><br></span></div><div><span><br></span></div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试结论：</span></b></span></div><div><span>一定程度上可以证明</span><span>文件下载的 URL 的依据是 xml 文件的 URL。</span></div><div><br></div><div><br></div><div><br></div><div><br></div><h2><b><span>测试三：SDK Manager&nbsp;</span><span>使用第三方提供的 xml 文件来下载包</span></b></h2><hr><div><span><br></span></div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试目标：</span></b></span></div><blockquote><div>第三方软件包：</div></blockquote><blockquote><blockquote><div>Amazon 软件包：</div></blockquote><blockquote><blockquote><ul><li>Amazon Fire Phone Build Tools</li><li>Kindle Fire USB Driver</li></ul></blockquote></blockquote></blockquote><div><span><br></span></div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试方法：</span></b></span></div><div><span>SDK Manager 上安装这 2 个软件包，查看安装时所使用的源</span></div><div><span><br></span></div><div style="text-align: left;"><span><b><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">测试结果</span></b></span></div><div><span>由安装时所使用的 URL （如下 URL）可以判定，安装时所使用的源均为第三方源。</span><span><br></span></div><blockquote><div><span><a href="http://s3.amazonaws.com/android-sdk-manager/redist/amazon_fire_phone_build_tools-windows.zip">http://s3.amazonaws.com/android-sdk-manager/redist/amazon_fire_phone_build_tools-windows.zip</a></span></div></blockquote><div><br></div><div><br></div><div><span><br></span></div><div><span><br></span></div><h2><span><b>测试最终结论：</b></span></h2><hr><div><span><br></span></div><div>由测试一、二、三可证明，推测“文件下载的 URL 的依据是 xml 文件的 URL”<span style="background-color:rgb(255, 0, 0);color:rgb(255, 255, 255)">成立</span>。</div><div><br></div><div><span><br></span></div><div><span><br></span></div><h1><span>Ref：</span></h1><hr><div><br></div><div><a href="https://stackoverflow.com/questions/21997920/user-defined-sites-in-android-sdk-manager-via-command-line">《StackOverflow - 通过命令行在 Android SDK 管理器中的“用户定义的站点”》</a><br></div><div><br></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><h1><span>引申推论：</span></h1><div><hr><span><br></span></div><div><span>由上述推论可得，</span><span>若要修改源，则只需修改 add-on site 里的 xml 。SDK Manager 中默认的源无法修改，只能添加新的源。</span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><h1><span>相关知识：</span></h1><hr><div><span><br></span></div><h2><span><b><span data-wiz-span="data-wiz-span">repository 相关配置文件的位置：</span></b></span></h2><div>SDK Manager 的 repository 相关的配置文件在<span>&nbsp;</span><u>%User_Home%\</u><u>.android</u><span>&nbsp;</span>中，如<span>&nbsp;</span><u>C:\Users\Administrator\.android</u><span>&nbsp;</span>。配置文件为：</div><div><ul><li>repositories.cfg</li><li>sites-settings.cfg</li></ul></div><br><div><span><br></span></div><div><span><br></span></div><div><span><br></span></div><div><br></div>
  <script type="text/javascript">
    /**
     * 让 iframe 中的 <a> 打开新页面
     */
    let aDoms = document.getElementsByTagName("a")
    for ( let aDom of aDoms ) {
      let oldHref = aDom.href;
      let newHref = "javascript:window.open('" + oldHref + "')";
      // console.info("aDom", aDom);
      aDom.href = newHref;
    }
  </script>
</body></html>